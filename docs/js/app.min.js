(()=>{"use strict";const e="&#128681",t=document.getElementById("app"),n=document.querySelector(".columns"),r=document.querySelector(".rows"),l=document.querySelector(".start"),a=document.querySelector(".reset"),o=document.querySelector(".flags"),i=document.querySelector(".mines"),c=function(e,t){const n=document.createElement("div");return n.className="mine-field",n}();let u;function s(t,n){u=0,o.innerText=`Количество установленных флагов: ${u}`;const r=Math.floor(n*t/6);c.style.gridTemplateColumns=`repeat(${t}, 1fr)`;const l=n*t;c.innerHTML='\n  <div class="cell" data-flag="0" data-open="0">\n  </div>\n  '.repeat(l);const a=[...c.children],s=[...Array(l).keys()].sort((()=>Math.random()-.5)).slice(0,r);function d(){const e=[];a.forEach((t=>{1==+t.getAttribute("data-open")&&e.push(t)})),console.log(e.length,a.length-s.length),e.length===a.length-s.length&&u===s.length&&(alert("ololo"),location.reload())}function f(){o.innerText=`Количество установленных флагов: ${u}`}function g(e,r){return r>=0&&r<n&&e>=0&&e<t}function p(e,n){if(!g(e,n))return;const r=a[n*t+e];if(y(e,n))return void a.forEach(((e,t)=>{s.includes(t)&&(e.innerHTML="&#x1F4A3",e.setAttribute("data-open","1"),e.style.backgroundColor="red")}));1==+r.getAttribute("data-flag")&&(u--,f());const l=function(e,t){let n=0;for(let r=-1;r<=1;r++)for(let l=-1;l<=1;l++)y(e+l,t+r)&&n++;return n}(e,n);if(0!==l)return r.setAttribute("data-flag","0"),r.innerHTML=l,r.setAttribute("data-open","1"),void f();if(1!=+r.getAttribute("data-open")){r.setAttribute("data-open","1"),r.setAttribute("data-flag","0"),r.innerHTML="",r.style.backgroundColor="rgba(0,0,0,0)",r.style.border="1px solid black";for(let t=-1;t<=1;t++)for(let r=-1;r<=1;r++)p(e+r,n+t)}}function y(e,n){if(!g(e,n))return!1;const r=n*t+e;return s.includes(r)}i.innerHTML=`Количество мин: ${s.length}`,c.addEventListener("click",(e=>{if("cell"!==e.target.className)return;const n=a.indexOf(e.target);p(n%t,Math.floor(n/t)),d()})),c.addEventListener("contextmenu",(t=>{t.preventDefault(),d();const n=t.target;"cell"!==n.className||1==+n.getAttribute("data-open")||+n.innerHTML>0||(n.innerHTML=e,0==+n.getAttribute("data-flag")?(n.setAttribute("data-flag","1"),n.innerHTML="",n.innerHTML=e,u++,f()):1==+n.getAttribute("data-flag")&&(n.setAttribute("data-flag","0"),n.innerHTML="",u--,f()))}))}t.append(c),a.addEventListener("click",(()=>{l.style.display="block",a.style.display="none"})),l.addEventListener("click",(e=>{e.preventDefault(),r.value>=8&&r.value<=16&&n.value>=8&&n.value<=16?(s(n.value,r.value),l.style.display="none",a.style.display="block"):alert("Введите правильное число строк и столбцов")}))})();