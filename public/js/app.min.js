(()=>{"use strict";function t(t,e){const a=document.createElement(t);return a.className=e,a}function e(t){return Math.floor(Math.random()*t)}const a=document.getElementById("app"),r=document.querySelector(".columns"),n=document.querySelector(".rows"),u=document.querySelector(".start"),o=document.querySelector(".reset"),i=document.querySelector(".flags"),l=document.querySelector(".mines"),d=t("div","mine-field");a.append(d);let c=0,g=0;const s=[];o.addEventListener("clisk",(()=>{c=0,g=0})),u.addEventListener("click",(a=>{if(a.preventDefault(),d.innerHTML="",r.value<=7||n.value<=7)return;d.style.gridTemplateColumns=`repeat(${r.value}, 1fr)`,d.style.gridTemplateColumns=`repeat(${n.value}, 1fr)`,function(a,u){for(let e=0;e<u;e++){s[e]=[];for(let r=0;r<a;r++){const a=t("div","cell");a.setAttribute("data-mine","0"),a.setAttribute("data-flag","0"),a.setAttribute("data-row",`${e}`),a.setAttribute("data-column",`${r}`),d.append(a),s[e].push(a)}}for(let t=0;t<Math.floor(n.value*r.value/6);t++)s[e(s.length)][e(s[0].length)].classList.add("mine");s.forEach((t=>{t.forEach((t=>{t.classList.contains("mine")&&t.setAttribute("data-mine","1")}))}))}(r.value,n.value),s.forEach((t=>{t.forEach((t=>{"1"===t.getAttribute("data-mine")&&g++}))}));const u=Array.from(document.querySelectorAll(".cell"));u.forEach((t=>{t.addEventListener("click",(()=>{t.classList.contains("mine")&&s.forEach((t=>{t.forEach((t=>{t.classList.contains("mine")&&(t.innerHTML="&#x1F4A3",t.style.backgroundColor="red")}))})),t.classList.contains("mine")||(t.style.backgroundColor="pink",function(t,e){let a=0;t.getAttribute("data-column"),t.getAttribute("data-row"),e.forEach((e=>{(+e.getAttribute("data-row")==+t.getAttribute("data-row")-1&&+e.getAttribute("data-column")==+t.getAttribute("data-column")-1&&1==+e.getAttribute("data-mine")||+e.getAttribute("data-row")==+t.getAttribute("data-row")-1&&+e.getAttribute("data-column")==+t.getAttribute("data-column")&&1==+e.getAttribute("data-mine")||+e.getAttribute("data-row")==+t.getAttribute("data-row")-1&&+e.getAttribute("data-column")==+t.getAttribute("data-column")+1&&1==+e.getAttribute("data-mine")||+e.getAttribute("data-row")==+t.getAttribute("data-row")&&+e.getAttribute("data-column")==+t.getAttribute("data-column")-1&&1==+e.getAttribute("data-mine")||+e.getAttribute("data-row")==+t.getAttribute("data-row")&&+e.getAttribute("data-column")==+t.getAttribute("data-column")+1&&1==+e.getAttribute("data-mine")||+e.getAttribute("data-row")==+t.getAttribute("data-row")+1&&+e.getAttribute("data-column")==+t.getAttribute("data-column")-1&&1==+e.getAttribute("data-mine")||+e.getAttribute("data-row")==+t.getAttribute("data-row")+1&&+e.getAttribute("data-column")==+t.getAttribute("data-column")&&1==+e.getAttribute("data-mine")||+e.getAttribute("data-row")==+t.getAttribute("data-row")+1&&+e.getAttribute("data-column")==+t.getAttribute("data-column")+1&&1==+e.getAttribute("data-mine"))&&a++})),t.innerHTML=a}(t,u))}))})),l.innerText=`Количество мин: ${g}`;for(let t=0;t<s.length;t++)s[t].forEach((t=>{t.addEventListener("contextmenu",(e=>{e.preventDefault(),"red"!==t.style.backgroundColor&&"pink"!==t.style.backgroundColor&&("0"===t.dataset.flag?(t.dataset.flag="1",t.innerHTML="",t.innerHTML="&#128681",c++,i.innerText=`Количество установленных флагов: ${c}`):"1"===t.dataset.flag&&(t.dataset.flag="0",t.innerHTML="",c--,i.innerText=`Количество установленных флагов: ${c}`))}))}));console.log(u),console.log(s)}))})();