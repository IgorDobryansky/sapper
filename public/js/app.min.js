(()=>{"use strict";function t(t,e){const a=document.createElement(t);return a.className=e,a}function e(t){return Math.floor(Math.random()*t)}const a=document.getElementById("app"),r=document.querySelector(".columns"),n=document.querySelector(".rows"),u=document.querySelector(".start"),i=document.querySelector(".reset"),o=document.querySelector(".flags"),l=document.querySelector(".mines"),d=t("div","mine-field");a.append(d);let c=0,g=0;const m=[];i.addEventListener("clisk",(()=>{c=0,g=0})),u.addEventListener("click",(a=>{if(a.preventDefault(),d.innerHTML="",r.value<=7||n.value<=7)return;d.style.gridTemplateColumns=`repeat(${r.value}, 1fr)`,d.style.gridTemplateColumns=`repeat(${n.value}, 1fr)`,function(a,u){for(let e=0;e<u;e++){m[e]=[];for(let r=0;r<a;r++){const a=t("div","cell");a.setAttribute("data-mine","0"),a.setAttribute("data-flag","0"),a.setAttribute("data-row",`${e}`),a.setAttribute("data-column",`${r}`),d.append(a),m[e].push(a)}}for(let t=0;t<Math.floor(n.value*r.value/6);t++)m[e(m.length)][e(m[0].length)].dataset.mine="1"}(r.value,n.value),m.forEach((t=>{t.forEach((t=>{"1"===t.getAttribute("data-mine")&&g++}))}));const u=Array.from(document.querySelectorAll(".cell"));u.forEach((t=>{t.addEventListener("click",(()=>{"1"===t.getAttribute("data-mine")&&m.forEach((t=>{t.forEach((t=>{"1"===t.getAttribute("data-mine")&&(t.innerHTML="&#x1F4A3",t.style.backgroundColor="red")}))})),"0"===t.getAttribute("data-mine")&&(t.style.backgroundColor="pink",function(t,e,a,r){let n=0;r.forEach((a=>{(+a.getAttribute("data-row")==+t-1&&+a.getAttribute("data-column")==+e-1&&1==+a.getAttribute("data-mine")||+a.getAttribute("data-row")==+t-1&&+a.getAttribute("data-column")==+e&&1==+a.getAttribute("data-mine")||+a.getAttribute("data-row")==+t-1&&+a.getAttribute("data-column")==+e+1&&1==+a.getAttribute("data-mine")||+a.getAttribute("data-row")==+t&&+a.getAttribute("data-column")==+e-1&&1==+a.getAttribute("data-mine")||+a.getAttribute("data-row")==+t&&+a.getAttribute("data-column")==+e+1&&1==+a.getAttribute("data-mine")||+a.getAttribute("data-row")==+t+1&&+a.getAttribute("data-column")==+e-1&&1==+a.getAttribute("data-mine")||+a.getAttribute("data-row")==+t+1&&+a.getAttribute("data-column")==+e&&1==+a.getAttribute("data-mine")||+a.getAttribute("data-row")==+t+1&&+a.getAttribute("data-column")==+e+1&&1==+a.getAttribute("data-mine"))&&n++})),a.innerHTML=n}(t.getAttribute("data-row"),t.getAttribute("data-column"),t,u))}))})),l.innerText=`Количество мин: ${g}`;for(let t=0;t<m.length;t++)m[t].forEach((t=>{t.addEventListener("contextmenu",(e=>{e.preventDefault(),"red"!==t.style.backgroundColor&&"pink"!==t.style.backgroundColor&&("0"===t.dataset.flag?(t.dataset.flag="1",t.innerHTML="",t.innerHTML="&#128681",c++,o.innerText=`Количество установленных флагов: ${c}`):"1"===t.dataset.flag&&(t.dataset.flag="0",t.innerHTML="",c--,o.innerText=`Количество установленных флагов: ${c}`))}))}))}))})();